{
  "name": "code-review",
  "version": "2.3.0",
  "description": "AI-powered code review with security audit, dependency scanning, architecture analysis, complexity metrics, and auto-refactoring. Use autoFix=true to automatically apply changes.",
  "author": "elio",
  "entrypoint": "run.sh",
  "instructions": "SKILL.md",
  "inputs": {
    "path": {
      "type": "string",
      "required": false,
      "default": ".",
      "description": "Path to review (file or directory)"
    },
    "scope": {
      "type": "string",
      "required": false,
      "default": "changed",
      "description": "Review scope: 'changed' (git diff), 'staged', 'full', or path"
    },
    "autoFix": {
      "type": "boolean",
      "required": false,
      "default": false,
      "description": "Auto-apply refactoring suggestions (split files, add types, etc.)"
    },
    "depth": {
      "type": "string",
      "required": false,
      "default": "standard",
      "description": "Analysis depth: 'quick' (syntax only), 'standard', 'deep' (architecture changes)"
    }
  },
  "outputs": {
    "score": {
      "type": "number",
      "description": "Code quality score 0-100"
    },
    "architecture_score": {
      "type": "number",
      "description": "Architecture health score 0-100"
    },
    "metrics": {
      "type": "object",
      "description": "Code metrics (total_lines, avg_per_file, large_files, complex_functions)"
    },
    "refactoring": {
      "type": "array",
      "description": "Specific refactoring recommendations with type and suggestion"
    },
    "summary": {
      "type": "object",
      "description": "Issue counts by severity"
    },
    "vulnerabilities": {
      "type": "object",
      "description": "Security vulnerabilities from npm audit"
    },
    "issues": {
      "type": "array",
      "description": "Found issues with severity and location"
    },
    "recommendation": {
      "type": "string",
      "description": "BLOCK, REVIEW, or APPROVE"
    }
  },
  "checks": {
    "security": [
      "SQL injection patterns",
      "Hardcoded credentials",
      "eval() usage",
      "Dynamic regex (ReDoS)",
      "npm audit vulnerabilities"
    ],
    "architecture": [
      "File size limits (200 lines)",
      "Function complexity",
      "Module structure"
    ],
    "type-safety": [
      "any type usage",
      "Proper type annotations"
    ],
    "dependencies": [
      "Outdated packages",
      "Security vulnerabilities",
      "Critical package updates"
    ],
    "best-practices": [
      "var vs const/let",
      "Error handling",
      "Async patterns"
    ]
  },
  "dependencies": ["wc", "find", "grep", "git", "npm"],
  "timeout": 180,
  "tags": ["code-quality", "security", "audit", "dependencies", "architecture", "refactoring"]
}
